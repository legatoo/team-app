<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>

    <title>jQuery UI Dialog - Modal form</title>
    <link type="text/css" href="/css/ui-lightness/jquery-ui-1.8.20.custom.css" rel="stylesheet" />

    <script src="/js/jquery-1.7.2.min.js"></script>
    <script src="/js/jquery.bgiframe-2.1.3.js"></script>
    <script src="/js/jquery-ui-1.8.20.custom.min.js"></script>

    <style>
        body { font-size: 62.5%; }
        label, input { display:block; }
        input.text { margin-bottom:12px; width:95%; padding: .4em; }
        fieldset { padding:0; border:0; margin-top:25px; }
        h1 { font-size: 1.2em; margin: .6em 0; }
        div#users-contain { width: 350px; margin: 20px 0; }
        div#users-contain table { margin: 1em 0; border-collapse: collapse; width: 100%; }
        div#users-contain table td, div#users-contain table th { border: 1px solid #eee; padding: .6em 10px; text-align: left; }
        .ui-dialog .ui-state-error { padding: .3em; }
        .validateTips { border: 1px solid transparent; padding: 0.3em; }
    </style>
    <script>
        $(function() {
            // a workaround for a flaw in the demo system (http://dev.jqueryui.com/ticket/4375), ignore!
            $( "#dialog:ui-dialog" ).dialog( "destroy" );

            var teamScore = $( "#teamScore" );
            var teacherComment = $( "#teacherComment" );
            var studentID = $("#studentID");
            allFields = $( [] ).add( teamScore ).add( teacherComment ),
                    tips = $( ".validateTips" );

            function updateTips( t ) {
                tips
                        .text( t )
                        .addClass( "ui-state-highlight" );
                setTimeout(function() {
                    tips.removeClass( "ui-state-highlight", 1500 );
                }, 500 );
            }

            function checkRegexp( o, regexp, n ) {
                if ( !( regexp.test( o.val() ) ) ) {
                    o.addClass( "ui-state-error" );
                    updateTips( n );
                    return false;
                } else {
                    return true;
                }
            }

            function checkScoreRange(score,n) {
                var check =  parseFloat(score);
                if (check > 100 || check < 0){
                    updateTips( n );
                    return false;
                }
                else{
                    return true;
                }

            }

            $( "#dialog-form" ).dialog({
                autoOpen: false,
                height: 300,
                width: 350,
                modal: true,
                buttons: {
                    "Score": function() {

                        var bValid = true;
                        allFields.removeClass( "ui-state-error" );

                        bValid = bValid && checkRegexp( teamScore, /^[0-9]{2,3}$/i,
                                "Score must be a positive digit." );
                        bValid = bValid && checkScoreRange( teamScore,
                                "Score must be in [0,100]");
                        if ( bValid ) {
                            $("#scoreForm").submit();
                            $( this ).dialog( "close" );
                        }

                    },
                    Cancel: function() {
                        $( this ).dialog( "close" );
                    }
                },
                close: function() {
                    allFields.val( "" ).removeClass( "ui-state-error" );
                }
            });

            $( "#Score-student" )
                    .button()
                    .click(function() {

                        $( "#dialog-form" ).dialog( "open" );
                    });
        });
    </script>
</head>
<body>



<div id="dialog-form" title="Create new user">
    <p class="validateTips">All form fields are required.</p>

    <form method="post" id="scoreForm">
        <fieldset>

            <input type="hidden" name="username" value={{teamMember.name}}>
            <label for="teamScore">Score</label>
            <input type="text" name="teamScore" id="teamScore" class="text ui-widget-content ui-corner-all" />
            <label for="teacherComment">Comment</label>
            <textarea type="text" name="teacherComment" id="teacherComment" rows="3" cols="55" ></textarea>

        </fieldset>
    </form>
</div>


<div id="users-contain" class="ui-widget">
    <div><b>Team {{team.teamName}}, Assignment {{assignmentName}} Grading Page</b></div>
    <div><b>Team leader:{{team.teamLeader}}</b></div>


    <table class="showUser">
        <tr>
            <th>student name</th>
            <th>studentID</th>
            <th>email</th>
            <th>team Role</th>
            <th>Upload Stuff</th>
            <th>Votes</th>
            <th>Person Score</th>
            <th>Teammate Comment</th>
            <th>Final Score</th>
            <th>Teacher Comment</th>
        </tr>

        {% for teamMember in team.teamMembers%}
        <tr>
            <td>{{teamMember.name}}</td>
            <td id="studentID">{{teamMember.studentID}}</td>
            <td>{{teamMember.email}}</td>
            <td>{{teamMember.teamRole}}</td>

            {% for score in teamMember.scores%}
            {% ifequal score.assignmentName assignmentName%}
            <td>{% for item in score.uploadStuff%} {{item}}. {% endfor%}</td>
            <td>{{score.votes}}</td>
            <td>{{score.personScore}}</td>
            <td>{% for comment in score.teammateComment%} {{comment}} {% endfor%}</td>
            <td>{{score.teamScore}}</td>
            <td>{{score.teacherComment}}</td>
            {% endifequal%}
            {% endfor%}

        </tr>

        {% endfor%}

    </table>
    <button id="Score-student">Score</button>
    <div class="error">{{error}}</div>
</div>

{% if googleMap%}
<img src="{{googleMap}}" >
{% endif%}
<hr>
{% for image in imageList%}
<img src={{image}}>
{% endfor%}
</body>
</html>
